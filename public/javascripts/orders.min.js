"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=exports.products;delete exports.products;var s=!1,t=function(e){var t=e.currentTarget.closest("td"),n=t.closest("tr"),i=n.closest(".modal"),a=n.getAttribute("data-item-index"),d=i.getAttribute("data-order-id");cityssm.confirmModal("Acknowledge Item?","Are you sure you want to mark this item as acknowledged?","Acknowledge","success",function(){cityssm.postJSON("/orders/doAcknowledgeItem",{orderID:d,itemIndex:a},function(e){if(e.success){s=!0;var i=r(e);t.remove(),n.appendChild(i)}})})},n=function(e,s){var t=s.formFieldsToSave.find(function(s){return s.formFieldName===e.formFieldName}),n=document.createElement("span");return n.innerHTML="<strong>"+cityssm.escapeHTML(t?t.fieldName:e.formFieldName)+":</strong> "+cityssm.escapeHTML(e.fieldValue),n},r=function(e){var s=document.createElement("td");if(s.className="has-text-centered",e.itemIsAcknowledged){s.classList.add("is-success");var n=new Date(e.acknowledgedTime);s.innerHTML="Acknowledged<br />"+cityssm.dateToString(n)+"<br />"+cityssm.escapeHTML(e.acknowledgedUser)}else{s.classList.add("is-warning");var r=document.createElement("button");r.className="button is-success",r.type="button",r.innerHTML="Acknowledge Item",r.addEventListener("click",t),s.appendChild(r)}return s},i=function(s){var t=e[s.productSKU],i=document.createElement("tr");i.setAttribute("data-item-index",s.itemIndex.toString()),i.insertAdjacentHTML("beforeend",'<th scope="row">'+(t?t.productName:s.productSKU)+"</th>");for(var a=document.createElement("td"),d=0,o=s.fields;d<o.length;d++){var c=o[d],l=n(c,t);a.appendChild(l),a.insertAdjacentHTML("beforeend","<br />")}i.appendChild(a);var m=r(s);return i.appendChild(m),i},a=function(e){var t=parseInt(e.currentTarget.getAttribute("data-order-index"),10),n=d[t];cityssm.openHtmlModal("order-view",{onshow:function(e){s=!1,e.setAttribute("data-order-id",n.orderID.toString()),e.getElementsByClassName("order--orderNumber")[0].innerText=n.orderNumber;var t=new Date(n.orderTime);e.getElementsByClassName("order--orderTime")[0].innerText=cityssm.dateToString(t)+" "+cityssm.dateToTimeString(t);var r=e.getElementsByClassName("order--statusMessage")[0];n.orderIsRefunded?(r.classList.add("is-warning"),r.innerHTML='<div class="message-body"><strong>This order has been marked as refunded.</strong></div>'):n.orderIsPaid?(r.classList.add("is-success"),r.innerHTML='<div class="message-body"><p class="has-text-weight-bold">This order has been marked as paid.</p></div>'):(r.classList.add("is-danger"),r.innerHTML='<div class="message-body"><strong>This order has been marked as unpaid.</strong></div>');for(var a=document.getElementsByClassName("order--items")[0],d=0,o=n.items;d<o.length;d++){var c=o[d],l=i(c);a.appendChild(l)}e.getElementsByClassName("order--shippingName")[0].innerText=n.shippingName,e.getElementsByClassName("order--shippingAddress")[0].innerHTML=cityssm.escapeHTML(n.shippingAddress1)+"<br />"+(n.shippingAddress2?cityssm.escapeHTML(n.shippingAddress2)+"<br />":"")+cityssm.escapeHTML(n.shippingCity)+", "+cityssm.escapeHTML(n.shippingProvince)+"<br />"+cityssm.escapeHTML(n.shippingPostalCode)+" &nbsp;"+cityssm.escapeHTML(n.shippingCountry),e.getElementsByClassName("order--shippingEmailAddress")[0].innerHTML='<a href="mailto:'+cityssm.escapeHTML(n.shippingEmailAddress)+'">'+n.shippingEmailAddress+"</a>",e.getElementsByClassName("order--shippingPhoneNumberDay")[0].innerText=n.shippingPhoneNumberDay,e.getElementsByClassName("order--shippingPhoneNumberEvening")[0].innerText=n.shippingPhoneNumberEvening},onhidden:function(){s&&m()}})},d=null,o=document.getElementById("container--results"),c=function(e,s){var t=document.createElement("a");t.className="panel-block is-block",t.href="#"+e.orderID.toString(),t.setAttribute("data-order-index",s.toString()),t.addEventListener("click",a);var n=new Date(e.orderTime),r="";return r=e.orderIsRefunded?'<span class="tag is-warning">Refunded</span>':e.orderIsPaid?'<span class="tag is-success">Paid</span>':'<span class="tag is-danger">Unpaid</span>',t.innerHTML='<div class="columns is-mobile is-multiline"><div class="column is-narrow is-vcentered"><span class="icon m-2">'+(function(e){for(var s=0,t=e.items;s<t.length;s++)if(!t[s].itemIsAcknowledged)return!1;return!0}(e)?'<i class="fas fa-3x fa-check-square is-success" title="Acknowledged"></i>':'<i class="far fa-3x fa-square" title="Not Acknowledged"></i>')+'</span></div><div class="column"><strong>'+cityssm.escapeHTML(e.orderNumber)+"</strong><br />"+cityssm.dateToString(n)+" "+cityssm.dateToTimeString(n)+' </div><div class="column is-full-mobile is-narrow has-text-right">'+r+"</div></div>",t},l=document.getElementById("form--filters"),m=function(){cityssm.clearElement(o),o.innerHTML='<div class="has-text-centered p-4"><span class="icon"><i class="fas fa-4x fa-spinner fa-pulse" aria-hidden="true"></i></span></div>',cityssm.postJSON("/orders/doGetOrders",l,function(e){d=e.orders,function(){if(0!==d.length){var e=document.createElement("div");e.className="panel has-background-white";for(var s=0;s<d.length;s+=1){var t=c(d[s],s);e.appendChild(t)}cityssm.clearElement(o),o.appendChild(e)}else o.innerHTML='<div class="message is-info"><div class="message-body">There are no orders available that meet your search criteria.</div></div>'}()})};m(),document.getElementById("filter--productSKU").addEventListener("change",m),document.getElementById("filter--orderStatus").addEventListener("change",m)}();